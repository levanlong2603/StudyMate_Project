<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="./assets/img/icon.svg" />
    <title>Đăng nhập - StudyMate Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #d30000;
            --primary-dark: #a00000;
            --secondary-color: #4a6fa5;
            --light-gray: #f5f5f5;
            --medium-gray: #e0e0e0;
            --dark-gray: #333;
            --error-color: #e74c3c;
            --success-color: #2ecc71;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-gray);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            background-image: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        
        .login-container {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 450px;
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }
        
        .login-container:hover {
            transform: translateY(-5px);
        }
        
        .login-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: var(--primary-color);
        }
        
        .logo {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .logo img {
            height: 50px;
        }
        
        .login-container h2 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
            font-weight: 600;
            font-size: 28px;
        }
        
        .input-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark-gray);
        }
        
        .input-group input {
            width: 100%;
            padding: 14px 15px 14px 40px;
            border: 1px solid var(--medium-gray);
            border-radius: 6px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .input-group input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(211, 0, 0, 0.1);
            outline: none;
        }
        
        .input-icon {
            position: absolute;
            left: 15px;
            top: 40px;
            color: var(--dark-gray);
            font-size: 18px;
        }
        
        .options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            font-size: 14px;
        }
        
        .remember-me {
            display: flex;
            align-items: center;
        }
        
        .remember-me input {
            margin-right: 8px;
            accent-color: var(--primary-color);
        }
        
        .forgot-password {
            color: var(--secondary-color);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .forgot-password:hover {
            color: var(--primary-color);
            text-decoration: underline;
        }
        
        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background-color: white;
            color: var(--dark-gray);
            border: 1px solid var(--medium-gray);
            margin-top: 15px;
        }
        
        .btn-secondary:hover {
            background-color: var(--light-gray);
        }
        
        .divider {
            display: flex;
            align-items: center;
            margin: 20px 0;
            color: var(--dark-gray);
            font-size: 14px;
        }
        
        .divider::before, .divider::after {
            content: "";
            flex: 1;
            border-bottom: 1px solid var(--medium-gray);
        }
        
        .divider::before {
            margin-right: 10px;
        }
        
        .divider::after {
            margin-left: 10px;
        }
        
        .social-login {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .social-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border: 1px solid var(--medium-gray);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .social-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .social-btn i {
            font-size: 20px;
        }
        
        .facebook-btn {
            color: #3b5998;
        }
        
        .google-btn {
            color: #db4437;
        }
        
        .github-btn {
            color: #333;
        }
        
        .register-link {
            text-align: center;
            margin-top: 25px;
            font-size: 15px;
        }
        
        .register-link a {
            color: var(--secondary-color);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s;
        }
        
        .register-link a:hover {
            color: var(--primary-color);
            text-decoration: underline;
        }
        
        .error-message {
            color: var(--error-color);
            font-size: 13px;
            margin-top: 5px;
            display: none;
        }
        
        .success-message {
            color: var(--success-color);
            font-size: 14px;
            text-align: center;
            margin-bottom: 20px;
            display: none;
        }
        
        .password-toggle {
            position: absolute;
            right: 15px;
            top: 40px;
            cursor: pointer;
            color: var(--dark-gray);
        }
        
        .loading {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @media (max-width: 480px) {
            .login-container {
                padding: 30px 20px;
            }
            
            .login-container h2 {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="logo">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/13/Logo_PTIT_University.png/640px-Logo_PTIT_University.png" alt="">
        </div>
        
        <h2>Đăng nhập tài khoản</h2>
        
        <div class="success-message" id="success-message"></div>
        
        <form id="login-form">
            <div class="input-group">
                <label for="email">Email</label>
                <i class="fas fa-envelope input-icon"></i>
                <input type="email" id="email" placeholder="Nhập email của bạn" required>
                <div class="error-message" id="email-error">Vui lòng nhập email hợp lệ</div>
            </div>
            
            <div class="input-group">
                <label for="password">Mật khẩu</label>
                <i class="fas fa-lock input-icon"></i>
                <input type="password" id="password" placeholder="Nhập mật khẩu" required>
                <i class="fas fa-eye password-toggle" id="toggle-password"></i>
                <div class="error-message" id="password-error">Vui lòng nhập mật khẩu</div>
            </div>
            
            <div class="options">
                <div class="remember-me">
                    <input type="checkbox" id="remember">
                    <label for="remember">Ghi nhớ tôi</label>
                </div>
                <a href="#" class="forgot-password" id="forgot-password">Quên mật khẩu?</a>
            </div>
            
            <button type="submit" class="btn btn-primary" id="login-btn">
                <span id="btn-text">Đăng nhập</span>
                <div class="loading" id="loading"></div>
            </button>
        </form>
        
        <div class="divider">hoặc đăng nhập bằng</div>
        
        <div class="social-login">
            <div class="social-btn facebook-btn" id="facebook-login">
                <i class="fab fa-facebook-f"></i>
            </div>
            <div class="social-btn google-btn" id="google-login">
                <i class="fab fa-google"></i>
            </div>
            <div class="social-btn github-btn" id="github-login">
                <i class="fab fa-github"></i>
            </div>
        </div>
        
        <button class="btn btn-secondary" id="guest-btn">
            <i class="fas fa-user"></i> Tiếp tục với tư cách khách
        </button>
        
        <div class="register-link">
            Chưa có tài khoản? <a href="#" id="register-link">Đăng ký ngay</a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const loginForm = document.getElementById('login-form');
            const emailInput = document.getElementById('email');
            const passwordInput = document.getElementById('password');
            const rememberCheckbox = document.getElementById('remember');
            const loginBtn = document.getElementById('login-btn');
            const guestBtn = document.getElementById('guest-btn');
            const forgotPasswordLink = document.getElementById('forgot-password');
            const registerLink = document.getElementById('register-link');
            const togglePassword = document.getElementById('toggle-password');
            const emailError = document.getElementById('email-error');
            const passwordError = document.getElementById('password-error');
            const successMessage = document.getElementById('success-message');
            const btnText = document.getElementById('btn-text');
            const loading = document.getElementById('loading');
            const facebookLogin = document.getElementById('facebook-login');
            const googleLogin = document.getElementById('google-login');
            const githubLogin = document.getElementById('github-login');

            // Check for saved credentials and success messages
            checkSavedCredentials();
            checkURLParams();

            // Event Listeners
            loginForm.addEventListener('submit', handleLogin);
            togglePassword.addEventListener('click', togglePasswordVisibility);
            guestBtn.addEventListener('click', continueAsGuest);
            forgotPasswordLink.addEventListener('click', handleForgotPassword);
            registerLink.addEventListener('click', handleRegister);
            facebookLogin.addEventListener('click', () => socialLogin('facebook'));
            googleLogin.addEventListener('click', () => socialLogin('google'));
            githubLogin.addEventListener('click', () => socialLogin('github'));

            // Check URL for success parameters (e.g., after registration or password reset)
            function checkURLParams() {
                const urlParams = new URLSearchParams(window.location.search);
                const message = urlParams.get('message');
                
                if (message) {
                    successMessage.textContent = decodeURIComponent(message);
                    successMessage.style.display = 'block';
                    
                    // Remove message from URL
                    window.history.replaceState({}, document.title, window.location.pathname);
                }
            }

            // Check for saved credentials
            function checkSavedCredentials() {
                const savedEmail = localStorage.getItem('studymate_email');
                const savedToken = localStorage.getItem('studymate_token');
                
                if (savedEmail && savedToken) {
                    emailInput.value = savedEmail;
                    rememberCheckbox.checked = true;
                    
                    // In a real app, you would validate the token with the server
                    // For demo, we'll just pre-fill the email
                }
            }

            // Handle login form submission
            async function handleLogin(e) {
                e.preventDefault();
                
                // Reset errors
                emailError.style.display = 'none';
                passwordError.style.display = 'none';
                
                // Get values
                const email = emailInput.value.trim();
                const password = passwordInput.value;
                const remember = rememberCheckbox.checked;
                
                // Validate inputs
                if (!validateInputs(email, password)) return;
                
                // Show loading state
                btnText.style.display = 'none';
                loading.style.display = 'block';
                loginBtn.disabled = true;
                
                try {
                    // Simulate API call with delay
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    
                    // In a real app, you would call your authentication API here
                    const authenticated = await authenticateUser(email, password);
                    
                    if (authenticated) {
                        // Successful login
                        handleSuccessfulLogin(email, remember);
                    } else {
                        // Failed login
                        showError('Email hoặc mật khẩu không đúng');
                    }
                } catch (error) {
                    showError('Đã xảy ra lỗi. Vui lòng thử lại sau.');
                    console.error('Login error:', error);
                } finally {
                    // Reset button state
                    btnText.style.display = 'block';
                    loading.style.display = 'none';
                    loginBtn.disabled = false;
                }
            }

            // Validate email and password
            function validateInputs(email, password) {
                let isValid = true;
                
                if (!email || !validateEmail(email)) {
                    emailError.style.display = 'block';
                    isValid = false;
                }
                
                if (!password) {
                    passwordError.style.display = 'block';
                    isValid = false;
                } else if (password.length < 6) {
                    passwordError.textContent = 'Mật khẩu phải có ít nhất 6 ký tự';
                    passwordError.style.display = 'block';
                    isValid = false;
                }
                
                return isValid;
            }

            // Email validation helper
            function validateEmail(email) {
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return re.test(email);
            }

            // Simulate user authentication
            async function authenticateUser(email, password) {
                // In a real app, this would be an API call to your backend
                // Example:
                // const response = await fetch('/api/auth/login', {
                //     method: 'POST',
                //     headers: { 'Content-Type': 'application/json' },
                //     body: JSON.stringify({ email, password })
                // });
                // return response.ok;
                
                // For demo purposes, we'll use mock data
                const mockUsers = [
                    { email: 'admin@studymate.com', password: 'Studymate123' },
                    { email: 'user@studymate.com', password: 'Password123' }
                ];
                
                return mockUsers.some(user => 
                    user.email === email && user.password === password
                );
            }

            // Handle successful login
            function handleSuccessfulLogin(email, remember) {
                // In a real app, you would receive a token from the server
                const mockToken = generateMockToken(email);
                
                // Save to session storage for current session
                sessionStorage.setItem('studymate_auth', 'true');
                sessionStorage.setItem('studymate_user', email);
                
                // Save to local storage if "remember me" is checked
                if (remember) {
                    localStorage.setItem('studymate_email', email);
                    localStorage.setItem('studymate_token', mockToken);
                } else {
                    localStorage.removeItem('studymate_email');
                    localStorage.removeItem('studymate_token');
                }
                
                // Redirect to dashboard
                window.location.href = './FrontEnd/home.html';
            }

            // Generate a mock token (for demo only)
            function generateMockToken(email) {
                return btoa(`mock-token:${email}:${Date.now()}`).replace(/=/g, '');
            }

            // Toggle password visibility
            function togglePasswordVisibility() {
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    togglePassword.classList.replace('fa-eye', 'fa-eye-slash');
                } else {
                    passwordInput.type = 'password';
                    togglePassword.classList.replace('fa-eye-slash', 'fa-eye');
                }
            }

            // Continue as guest
            function continueAsGuest() {
                sessionStorage.setItem('studymate_guest', 'true');
                window.location.href = 'home.html';
            }

            // Handle forgot password
            function handleForgotPassword(e) {
                e.preventDefault();
                const email = emailInput.value.trim();
                
                if (email && validateEmail(email)) {
                    // In a real app, you would call your password reset API
                    alert(`Yêu cầu đặt lại mật khẩu đã được gửi đến ${email}`);
                } else {
                    window.location.href = 'forgot-password.html';
                }
            }

            // Handle register
            function handleRegister(e) {
                e.preventDefault();
                window.location.href = 'register.html';
            }

            // Social login
            function socialLogin(provider) {
                // In a real app, this would redirect to the provider's OAuth endpoint
                // or use their SDK (like Firebase Auth)
                alert(`Đăng nhập bằng ${provider} đang được phát triển`);
            }

            // Show error message
            function showError(message) {
                passwordError.textContent = message;
                passwordError.style.display = 'block';
                passwordInput.focus();
            }
        });
    </script>
</body>
</html>